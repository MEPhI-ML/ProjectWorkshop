# Мониторинг экосистемы через IT-решения

## Описание проекта

Данный проект демонстрирует применение готовых NLP-моделей машинного обучения для анализа данных экологических сенсоров в рамках задачи мониторинга экосистемы. Проект решает проблему автоматической интерпретации больших объёмов данных сенсоров и генерации понятных отчётов о состоянии окружающей среды.

### Проблема

Окружающая среда подвергается постоянным изменениям под влиянием естественных факторов и человеческой деятельности. Экологам, научным исследователям и властям необходимы надёжные данные для мониторинга состояния экосистем, принятия обоснованных решений по охране природы и реагирования на экологические вызовы. Однако традиционные методы сбора и анализа данных трудоёмки и часто подвержены ошибкам.

### Решение

Проект представляет IT-решение, которое:

- **Работает с данными сенсоров**: обрабатывает показания экологических станций (PM2.5, CO₂, температура, влажность, скорость ветра)
- **Применяет предобученные модели ML**: использует NLP-модели для автоматической классификации экологической ситуации и генерации кратких отчётов
- **Автоматизирует анализ**: преобразует числовые данные в текстовые описания и выполняет интеллектуальную классификацию без дополнительного обучения
- **Генерирует отчёты**: создаёт краткие резюме для операторов и специалистов

## Цели проекта и бизнес-задача

**Бизнес-задача:**

Экологическая служба хочет оперативно получать отчёты о состоянии воздуха в различных районах города, автоматически классифицировать уровень загрязнения и генерировать краткие резюме для операторов. Традиционные методы анализа данных сенсоров требуют ручной обработки и интерпретации, что замедляет процесс принятия решений и увеличивает вероятность ошибок.

**Цели проекта:**

1. Автоматизировать анализ данных экологических сенсоров с помощью предобученных NLP-моделей
2. Обеспечить оперативную классификацию экологической ситуации без необходимости обучения собственных моделей
3. Генерировать понятные текстовые отчёты для специалистов и операторов
4. Демонстрировать применение готовых моделей машинного обучения для решения практических задач экологического мониторинга

## Определение области и перевод задачи в DS-термины

**Область машинного обучения:** Natural Language Processing (NLP)

**Тип задачи:**

1. **Zero-shot Text Classification** - классификация текстовых описаний экологической ситуации по заранее заданным классам без дополнительного обучения модели
2. **Text Summarization** - автоматическое сжатие развёрнутых текстовых отчётов в краткие резюме

**DS-задача:**

- **Входные данные:** временные ряды числовых показаний сенсоров (PM2.5, CO₂, температура, влажность, скорость ветра)
- **Предобработка:** преобразование числовых данных в текстовые описания на естественном языке (feature engineering)
- **Задача 1 (Classification):** многоклассовая классификация текстовых описаний на 4 класса: "clean air", "moderate air pollution", "high air pollution", "dangerous air pollution"
- **Задача 2 (Summarization):** сжатие развёрнутых текстовых отчётов в краткие резюме (20-60 токенов)
- **Выходные данные:** метки классов с оценкой уверенности, краткие текстовые резюме

**Особенности подхода:**

- Использование zero-shot классификации (без fine-tuning)
- Feature engineering: создание текстовых описаний из числовых данных
- Применение предобученных трансформерных моделей (BART)

## Технологии и модели

Проект использует следующие предобученные модели машинного обучения:

1. **[facebook/bart-large-mnli](https://huggingface.co/facebook/bart-large-mnli)** - модель для zero-shot классификации экологической ситуации по текстовым описаниям данных сенсоров
2. **[facebook/bart-large-cnn](https://huggingface.co/facebook/bart-large-cnn)** - модель для автоматического сжатия и обобщения суточных отчётов о качестве воздуха

### Обоснование выбранных моделей

**Почему BART-large-MNLI:**

- **Zero-shot классификация**: модель способна классифицировать тексты по заданным категориям без дополнительного обучения, что подходит для быстрого развёртывания решения
- **Высокое качество**: модель показывает отличные результаты на задачах естественного вывода (Natural Language Inference), что позволяет точно интерпретировать описания экологической ситуации
- **Гибкость**: можно легко изменить набор классов классификации без переобучения модели
- **Готовность к использованию**: предобученная модель доступна через Hugging Face и готова к работе сразу после установки

**Почему BART-large-CNN:**

- **Специализация на summarization**: модель обучена для задачи сжатия текста, что обеспечивает качественное создание кратких резюме
- **Оптимальный баланс**: модель обеспечивает хорошее соотношение между качеством сжатия и скоростью работы
- **Сохранение ключевой информации**: модель эффективно выделяет наиболее важные факты из развёрнутых отчётов
- **Интеграция с экосистемой**: модель совместима с той же библиотекой transformers, что упрощает интеграцию в проект

### Используемые библиотеки

- `transformers` - для работы с предобученными моделями
- `pandas` - для обработки данных
- `numpy` - для численных вычислений
- `accelerate` - для оптимизации работы с GPU
- `datetime` - для работы с датами и временем (встроенная библиотека Python)

## Архитектура решения / Пайплайн анализа

Проект реализует следующий пайплайн обработки данных:

```
Генерация данных → Предобработка → Классификация → Отчёт → Резюме
     ↓                ↓                ↓            ↓         ↓
  Сенсоры        Тренды PM2.5    Zero-shot      Текстовый  Сжатие
  (PM2.5, CO₂,   Пороговая       классификация  отчёт      отчёта
   температура,  классификация    (BART-MNLI)    (суточный) (BART-CNN)
   влажность,
   скорость
   ветра)
```

**Этапы пайплайна:**

1. **Генерация данных** - создание синтетических данных сенсоров для трёх районов города
2. **Предобработка** - вычисление трендов PM2.5, пороговая классификация, формирование текстовых описаний
3. **Классификация** - применение zero-shot классификации для определения экологической ситуации
4. **Отчёт** - формирование развёрнутого текстового отчёта на основе агрегированных данных
5. **Резюме** - автоматическое сжатие отчёта для операторов

## Описание входных и выходных данных

### Входные данные

**Формат:** DataFrame (pandas)

**Структура данных сенсоров:**

| Колонка       | Тип      | Описание                    | Пример значения            |
| ------------- | -------- | --------------------------- | -------------------------- |
| `timestamp`   | datetime | Временная метка измерения   | 2025-01-01 00:00:00        |
| `area`        | string   | Район города                | "North", "South", "Center" |
| `pm25`        | float    | Концентрация PM2.5 (мкг/м³) | 25.3                       |
| `co2`         | float    | Концентрация CO₂ (ppm)      | 450                        |
| `temperature` | float    | Температура (°C)            | 5.2                        |
| `humidity`    | float    | Относительная влажность (%) | 75                         |
| `wind_speed`  | float    | Скорость ветра (м/с)        | 2.1                        |

**Пример входной строки:**

```python
{
    'timestamp': Timestamp('2025-01-01 00:00:00'),
    'area': 'North',
    'pm25': 25.3,
    'co2': 450,
    'temperature': 5.2,
    'humidity': 75,
    'wind_speed': 2.1
}
```

### Выходные данные

**Основной результат - DataFrame с результатами анализа:**

| Колонка               | Тип    | Описание                                                                                                     |
| --------------------- | ------ | ------------------------------------------------------------------------------------------------------------ |
| Все входные колонки   | -      | Исходные данные сенсоров                                                                                     |
| `pm25_level_rule`     | string | Пороговая классификация: "clean", "moderate", "high", "dangerous"                                            |
| `pm25_trend`          | string | Тренд изменения: "rising fast", "rising", "stable", "falling", "falling fast"                                |
| `description_en`      | string | Текстовое описание состояния воздуха на английском языке                                                     |
| `situation_zero_shot` | string | Классификация модели: "clean air", "moderate air pollution", "high air pollution", "dangerous air pollution" |
| `situation_score`     | float  | Уверенность модели в классификации (0-1)                                                                     |

**Пример выходной строки:**

```python
{
    'timestamp': Timestamp('2025-01-01 00:00:00'),
    'area': 'North',
    'pm25': 25.3,
    'pm25_level_rule': 'moderate',
    'pm25_trend': 'stable',
    'situation_zero_shot': 'moderate air pollution',
    'situation_score': 0.87
}
```

**Дополнительный результат - сжатый отчёт:**

Текстовое резюме суточного отчёта о качестве воздуха, сгенерированное моделью BART-large-CNN.

## Источники данных

Проект использует **синтетически сгенерированные данные**, имитирующие показания экологических станций.  
Отдельного внешнего датасета нет: данные генерируются внутри ноутбука `Bart_large.ipynb` в разделе "Генерация синтетических данных сенсоров".

**Параметры генерации:**

- Период: 1 неделя (1-7 января 2025)
- Частота измерений: каждые 30 минут
- Районы: North, South, Center
- Параметры: PM2.5, CO₂, температура, влажность, скорость ветра

## Структура проекта

```
ProjectWorkshop/
├── Bart_large.ipynb    # Основной файл проекта (Jupyter notebook)
└── README.md           # Документация проекта
```

## Использование

### Требования

- Python 3.7 или выше
- Jupyter Notebook или Google Colab для запуска проекта
- CUDA-совместимая видеокарта (опционально, для ускорения работы моделей)

### Запуск проекта

Проект разработан для работы в **Jupyter Notebook** или **Google Colab**:

1. Откройте файл `Bart_large.ipynb` в Google Colab или Jupyter Notebook
2. Запустите первую ячейку для установки зависимостей
3. Выполните все остальные ячейки последовательно

### Описание работы

Notebook выполняет следующие этапы:

1. **Генерация синтетических данных сенсоров**

   - Создаётся набор данных, имитирующий работу городских экологических станций
   - Для трёх районов города (North, South, Center) моделируются показания сенсоров с интервалом 30 минут в течение недели
   - Данные включают: PM2.5, CO₂, температура, влажность, скорость ветра
   - Включаются аномальные всплески PM2.5 для реалистичности

2. **Базовая классификация уровня загрязнения**

   - Выполняется пороговая классификация по PM2.5:
     - менее 15 - clean (чистый воздух)
     - 15–35 - moderate (умеренное загрязнение)
     - 35–75 - high (высокое загрязнение)
     - выше 75 - dangerous (опасное загрязнение)

3. **Определение тренда изменения PM2.5**

   - Вычисляется динамика изменения концентрации PM2.5 за последние 1.5 часа
   - Классификация тренда: rising fast, rising, stable, falling, falling fast

4. **Формирование текстового описания**

   - Числовые показания сенсоров преобразуются в текстовое описание на английском языке
   - Описание включает: район, все параметры сенсоров, тренд PM2.5, оценку уровня загрязнения и риска для здоровья

5. **Zero-shot классификация экологической ситуации**

   - Используется модель `facebook/bart-large-mnli` для классификации ситуации
   - Модель выбирает один из классов: clean air, moderate air pollution, high air pollution, dangerous air pollution
   - Результат сохраняется вместе с оценкой уверенности модели

6. **Генерация и сжатие суточного отчёта**
   - Создаётся развёрнутый текстовый отчёт о качестве воздуха за день
   - Используется модель `facebook/bart-large-cnn` для автоматического сжатия отчёта
   - Генерируется краткое резюме для оператора

## Результаты работы

После выполнения всех ячеек notebook вы получите:

- DataFrame с исходными данными сенсоров и результатами анализа
- Классификацию экологической ситуации для каждого измерения
- Оценку уверенности модели в классификации
- Краткое резюме суточного отчёта

## Особенности реализации

- **Zero-shot классификация**: модель работает без дополнительного обучения, используя только предобученные знания
- **Автоматическая обработка**: весь процесс от данных сенсоров до классификации и отчётов выполняется автоматически
- **GPU-ускорение**: при наличии CUDA-совместимой видеокарты модели автоматически используют GPU для ускорения вычислений
- **Структурированный код**: код разделён на логические блоки, каждый блок имеет комментарий в markdown-формате с описанием, что делает этот код.

## Ограничения и риски

**Ограничения проекта:**

1. **Языковая зависимость**: модели BART обучены на английском языке, поэтому текстовые описания должны быть на английском. Это требует дополнительного шага перевода при работе с русскоязычными данными.

2. **Синтетические данные**: проект использует синтетически сгенерированные данные, которые могут не полностью отражать реальные условия работы экологических станций.

3. **Производительность**: модели требуют значительных вычислительных ресурсов, особенно при обработке больших объёмов данных. Рекомендуется использование GPU для ускорения работы.

4. **Точность классификации**: zero-shot классификация может быть менее точной, чем специализированные обученные модели, особенно для специфических доменов.

5. **Статичность классов**: набор классов классификации задаётся заранее и не может быть изменён без перезапуска модели.

**Риски:**

- Задержки при загрузке моделей из Hugging Face при первом запуске
- Необходимость интернет-соединения для загрузки предобученных моделей
- Возможные ошибки интерпретации при нестандартных значениях параметров сенсоров

## Применение в реальных условиях

Данное решение может быть адаптировано для:

- Мониторинга качества воздуха в городах
- Автоматического анализа данных экологических станций
- Генерации отчётов для экологических служб
- Системы раннего предупреждения о загрязнении воздуха
- Интеграции в более крупные системы экологического мониторинга

## Заключение

Проект демонстрирует применение готовых NLP-моделей машинного обучения для решения задач экологического мониторинга. Использование предобученных моделей позволяет быстро развернуть систему анализа данных сенсоров без необходимости обучения собственных моделей, что делает решение доступным и масштабируемым.

## Автор

Капсет Артём.

## Лицензия

Проект выполнен в учебных целях.
